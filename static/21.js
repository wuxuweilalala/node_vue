webpackJsonp([21],{2021:function(e,t,n){function a(e){n(2277)}var r=n(11);var o=n(2279);var i=n(2280);var s=false;var c=a;var p="data-v-5fbf3c6f";var A=null;var d=r(o,i,s,c,p,A);e.exports=d.exports},2277:function(e,t,n){var a=n(2278);if(typeof a==="string")a=[[e.i,a,""]];if(a.locals)e.exports=a.locals;var r=n(10)("4ddd0e1a",a,true,{})},2278:function(e,t,n){t=e.exports=n(9)(true);t.push([e.i,"\n.wrapper[data-v-5fbf3c6f] {\n  overflow: hidden;\n  background-repeat: no-repeat !important;\n  background-position: center !important;\n  background-size: cover !important;\n}\n.wrapper.mobileLayout[data-v-5fbf3c6f] {\n  overflow: scroll;\n}\n.wrapper.overflowY[data-v-5fbf3c6f] {\n  padding-top: 40px;\n}\n.wrapper[data-v-5fbf3c6f] .draggable {\n  position: absolute;\n  float: left;\n  -webkit-transform-origin: 0 0;\n          transform-origin: 0 0;\n  background-color: transparent;\n  color: transparent;\n  border: solid 0.0625vw transparent;\n}\n.wrapper[data-v-5fbf3c6f] .handle {\n  z-index: 999;\n  /* background-color: #28b3fc; */\n  border: none;\n  width: 0.3vw;\n  height: 0.3vw;\n}\n\n/* .wrapper /deep/ .draggable.active {\n  border-color: #28b3fc;\n} */\n.wrapper[data-v-5fbf3c6f] .handle-tm {\n  top: -0.15vw;\n  margin-left: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-bm {\n  bottom: -0.15vw;\n  margin-left: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-tr {\n  top: -0.15vw;\n  right: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-bl {\n  bottom: -0.15vw;\n  left: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-br {\n  bottom: -0.15vw;\n  right: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-tl {\n  top: -0.15vw;\n  left: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-mr {\n  right: -0.15vw;\n  margin-top: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-ml {\n  left: -0.15vw;\n  margin-top: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .container {\n  /*overflow: hidden;*/\n  /*position: absolute;*/\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.wrapper[data-v-5fbf3c6f] .bg {\n  z-index: 2;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-size: 100% 100%;\n}\n.wrapper[data-v-5fbf3c6f] .moreOption {\n  position: absolute;\n  top: 0.3vw;\n  right: 0.6vw;\n}\n.wrapper[data-v-5fbf3c6f] .moreOption:hover {\n  opacity: 1;\n}\n.wrapper[data-v-5fbf3c6f] .dataDimension {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.wrapper[data-v-5fbf3c6f] .container .echarts {\n  /*top: 0;*/\n  /*left: 0;*/\n  width: 100%;\n  height: 100%;\n}\n.component-container[data-v-5fbf3c6f] {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n","",{version:3,sources:["D:/phpStudy/PHPTutorial/WWW/bi-vue/src/pages/Visualization/Project/components/CanvasPlace/previewPages.vue"],names:[],mappings:";AACA;EACE,iBAAiB;EACjB,wCAAwC;EACxC,uCAAuC;EACvC,kCAAkC;CACnC;AACD;EACE,iBAAiB;CAClB;AACD;EACE,kBAAkB;CACnB;AACD;EACE,mBAAmB;EACnB,YAAY;EACZ,8BAA8B;UACtB,sBAAsB;EAC9B,8BAA8B;EAC9B,mBAAmB;EACnB,mCAAmC;CACpC;AACD;EACE,aAAa;EACb,gCAAgC;EAChC,aAAa;EACb,aAAa;EACb,cAAc;CACf;;AAED;;IAEI;AACJ;EACE,aAAa;EACb,qBAAqB;CACtB;AACD;EACE,gBAAgB;EAChB,qBAAqB;CACtB;AACD;EACE,aAAa;EACb,eAAe;CAChB;AACD;EACE,gBAAgB;EAChB,cAAc;CACf;AACD;EACE,gBAAgB;EAChB,eAAe;CAChB;AACD;EACE,aAAa;EACb,cAAc;CACf;AACD;EACE,eAAe;EACf,oBAAoB;CACrB;AACD;EACE,cAAc;EACd,oBAAoB;CACrB;AACD;EACE,qBAAqB;EACrB,uBAAuB;EACvB,OAAO;EACP,QAAQ;EACR,YAAY;EACZ,aAAa;CACd;AACD;EACE,WAAW;EACX,mBAAmB;EACnB,OAAO;EACP,QAAQ;EACR,YAAY;EACZ,aAAa;EACb,2BAA2B;CAC5B;AACD;EACE,mBAAmB;EACnB,WAAW;EACX,aAAa;CACd;AACD;EACE,WAAW;CACZ;AACD;EACE,mBAAmB;EACnB,OAAO;EACP,QAAQ;EACR,YAAY;EACZ,aAAa;CACd;AACD;EACE,WAAW;EACX,YAAY;EACZ,YAAY;EACZ,aAAa;CACd;AACD;EACE,mBAAmB;EACnB,QAAQ;EACR,OAAO;CACR",file:"previewPages.vue",sourcesContent:["\n.wrapper[data-v-5fbf3c6f] {\n  overflow: hidden;\n  background-repeat: no-repeat !important;\n  background-position: center !important;\n  background-size: cover !important;\n}\n.wrapper.mobileLayout[data-v-5fbf3c6f] {\n  overflow: scroll;\n}\n.wrapper.overflowY[data-v-5fbf3c6f] {\n  padding-top: 40px;\n}\n.wrapper[data-v-5fbf3c6f] .draggable {\n  position: absolute;\n  float: left;\n  -webkit-transform-origin: 0 0;\n          transform-origin: 0 0;\n  background-color: transparent;\n  color: transparent;\n  border: solid 0.0625vw transparent;\n}\n.wrapper[data-v-5fbf3c6f] .handle {\n  z-index: 999;\n  /* background-color: #28b3fc; */\n  border: none;\n  width: 0.3vw;\n  height: 0.3vw;\n}\n\n/* .wrapper /deep/ .draggable.active {\n  border-color: #28b3fc;\n} */\n.wrapper[data-v-5fbf3c6f] .handle-tm {\n  top: -0.15vw;\n  margin-left: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-bm {\n  bottom: -0.15vw;\n  margin-left: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-tr {\n  top: -0.15vw;\n  right: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-bl {\n  bottom: -0.15vw;\n  left: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-br {\n  bottom: -0.15vw;\n  right: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-tl {\n  top: -0.15vw;\n  left: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-mr {\n  right: -0.15vw;\n  margin-top: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .handle-ml {\n  left: -0.15vw;\n  margin-top: -0.15vw;\n}\n.wrapper[data-v-5fbf3c6f] .container {\n  /*overflow: hidden;*/\n  /*position: absolute;*/\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.wrapper[data-v-5fbf3c6f] .bg {\n  z-index: 2;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-size: 100% 100%;\n}\n.wrapper[data-v-5fbf3c6f] .moreOption {\n  position: absolute;\n  top: 0.3vw;\n  right: 0.6vw;\n}\n.wrapper[data-v-5fbf3c6f] .moreOption:hover {\n  opacity: 1;\n}\n.wrapper[data-v-5fbf3c6f] .dataDimension {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.wrapper[data-v-5fbf3c6f] .container .echarts {\n  /*top: 0;*/\n  /*left: 0;*/\n  width: 100%;\n  height: 100%;\n}\n.component-container[data-v-5fbf3c6f] {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n"],sourceRoot:""}])},2279:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=n(79);var r=n.n(a);var o=n(19);var i=n.n(o);var s=n(74);var c=n.n(s);var p=n(22);var A=n.n(p);var d=n(392);var f=n.n(d);var l=n(93);var h=n.n(l);var v=n(394);var b=n(775);var C=n(87);var u=n(178);t["default"]={name:"PreviewPages",mixins:[v["a"]],components:{Loading:f.a,LoadingRotating:h.a},data:function e(){return{isMobileLayoutSaved:false,isMobileDevice:false,mobilePagesNum:1,shareType:1,dataIsOk:false,recordTime:1e3*5,intervalId:0,styleObj:{width:"100%",height:"100%"},bgColor:"",imgBase64:"",dashboardWidth:"",dashboardHeight:""}},computed:i()({canvasPositionClass:function e(){if(this.isMobileDevice)return["mobileLayout"];var t=[];if(this.screenWidth>this.dashboardWidth&&this.screenHeight>this.dashboardHeight){t.push("allCenter");return t}if(this.screenWidth>this.dashboardWidth){t.push("aCenter")}if(this.screenHeight>this.dashboardHeight){t.push("vCenter")}else{t.push("overflowY")}return t}},Object(p["mapGetters"])("main",{screenWidth:"getScreenWidth",screenHeight:"getScreenHeight"}),Object(p["mapGetters"])("canvasPlace",{chartList:"getChartList",scaleLevel:"getScaleLevel",renderedChartCount:"getRenderedChartCount"}),Object(p["mapGetters"])("config",{baseUrl:"baseUrl"}),{getChartList:function e(){if(this.isMobileDevice){return this.chartListFilter}else{return this.chartList}},chartListFilter:function e(){return this.chartList.filter(function(e){return e.containerOptions.showInMobileLayout&&e.containerStatus.isSetOptions})}}),watch:{dataIsOk:function e(t){if(t)document.dispatchEvent(new Event("render-active"))}},methods:{activateSocket:function e(t){var n=this;var a="wss://socketbi.24e.co/";var r=new WebSocket(a);r.onopen=function(e){};r.onmessage=function(e){var a=JSON.parse(e.data);if(a.connectFd){t.fd=a.connectFd;n.axios.get("https://pushbi.24e.co",{params:t}).then(function(e){})}else{n.$store.dispatch("canvasPlace/screeningRequest")}}},getUrlParams:function e(){var t=this;var n={share_sn:t.$route.query.share_sn,password:t.$route.query.password};var a=t.baseUrl+"api/shareInfo";t.axios.get(a,{params:n}).then(function(e){var n=e.data;console.log("resNew",n);console.log(n.data.dashboardBgColor);t.bgColor=n.data.dashboardBgColor||"#0b0e14";t.imgBase64=n.data.dashboardBgImage;t.dashboardHeight=n.data.dashboardHeight;t.dashboardWidth=n.data.dashboardWidth;if(n.code=="000000"){if(n.data.pushInfo.pushState){t.activateSocket({product_sn:n.data.project_sn,time:n.data.pushInfo.pushTime})}t.dataIsOk=true;document.title=n.data.project_name;t.isMobileLayoutSaved=n.data.isMobileLayoutSaved;t.shareType=n.data.share_type;t.$store.commit("canvasPlace/clearArrChart");if(!t.chartList.length){var a=n.data.share_info;if(a.length){a.forEach(function(e,n){var a=e.containerOptions;var r=e.containerOptions.chartsType.split("-")[0];if(t.shareType==2){a.xPosition=0;a.yPosition=0}var o={id:n,containerOptions:a,containerStatus:{isSetOptions:true,dataDimensionShow:false,isDeleted:false,isShowLoading:false}};var i=Object(C["a"])(e).renderOptions;t.$set(o,"renderOptions",i);t.$store.commit("canvasPlace/setChartList",o)})}else{t.dataIsOk=true}}}else{t.dataIsOk=true;t.tips.show([n.err_msg])}}).catch(function(e){t.dataIsOk=true;console.error(e)})},recordShareTime:function e(){var t=this;var n=t.baseUrl+"api/recordShare";var a=t.$route.query.share_sn;var r=t.$route.query.func||"";var o=setInterval(function(){if(!r){t.axios.get(n+"?share_sn="+a).then(function(e){if(e.data.code!="000000"){t.tips.show([e.data.err_msg])}}).catch(function(e){return console.error(e)})}else{clearInterval(o)}},5e3)}},beforeMount:function e(){this.isMobileDevice=navigator.userAgent.toLowerCase().match(/(ipod|iphone|android|coolpad|mmp|smartphone|midp|wap|xoom|symbian|j2me|blackberry|wince)/i)!=null},mounted:function e(){var t=this;t.getUrlParams();t.recordShareTime();setTimeout(function(){if(t.isMobileDevice){document.querySelector("html").style.overflow="auto";var e=t.chartListFilter.map(function(e){return Number(e.containerOptions.yPositionMobile)+Number(e.containerOptions.tableHeightMobile)});var n=e.length?Math.max.apply(Math,r()(e)):1;t.mobilePagesNum=n>1?Math.ceil(n/t.screenHeight):1;console.log(t.mobilePagesNum)}},1e3)}}},2280:function(e,t){var n=function(){var e=this;var t=e.$createElement;var n=e._self._c||t;return n("div",{staticClass:"wrapper",class:e.canvasPositionClass,style:{backgroundColor:e.bgColor,backgroundImage:"url("+e.imgBase64+")",height:e.isMobileDevice?e.mobilePagesNum*100+"vh":e.dashboardHeight+"px",width:e.isMobileDevice?"100vw":e.dashboardWidth+"px"}},[e.isMobileDevice&&!e.dataIsOk?n("loading-rotating",{attrs:{styleObj:e.styleObj}}):e._e(),e._v(" "),!e.isMobileDevice?n("Loading",{attrs:{dataIsOk:e.dataIsOk,styleObj:e.styleObj}}):e._e(),e._v(" "),e._l(e.getChartList,function(t,a){return n("div",{key:a,staticClass:"component-container",style:{width:!e.isMobileDevice?Number(t.containerOptions.tableWidth)+"px":Number(t.containerOptions.tableWidthMobile*e.screenWidth)+"px",height:!e.isMobileDevice?Number(t.containerOptions.tableHeight)+"px":Number(t.containerOptions.tableHeightMobile)+"px",left:(!e.isMobileDevice?Number(t.containerOptions.xPosition):Number(t.containerOptions.xPositionMobile))+"px",top:(!e.isMobileDevice?Number(t.containerOptions.yPosition):Number(t.containerOptions.yPositionMobile))+"px",position:e.isMobileLayoutSaved||!e.isMobileDevice?"absolute":"static",float:e.isMobileLayoutSaved?"usnet":"left",zIndex:Number(t.containerOptions.level)||0}},[n(t.containerOptions.chartsType,{tag:"component",style:{"z-index":t.containerOptions.level+3||3},attrs:{chartIndex:a,options:t.renderOptions,containerOptions:t.containerOptions,containerStatus:t.containerStatus,isSetOptions:t.containerStatus.isSetOptions}})],1)})],2)};var a=[];e.exports={render:n,staticRenderFns:a}}});